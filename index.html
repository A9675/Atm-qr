<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ATM QR - Anil Digital</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2ecc71">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: #f2f2f2;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    .input-card {
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 360px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .input-card input {
      width: 100%;
      padding: 10px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-bottom: 12px;
    }
    .input-card button {
      width: 100%;
      padding: 12px;
      background-color: #2ecc71;
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .input-card button:hover {
      background-color: #27ae60;
    }
    .card {
      display: none;
      width: 100%;
      max-width: 360px;
      aspect-ratio: 1.6;
      background: #2ecc71;
      border-radius: 12px;
      border: 3px solid #f50057;
      color: black;
      position: relative;
      padding: 7px;
      overflow: hidden;
      margin-bottom: 7px;
      flex-direction: column;
      justify-content: center;
    }
    .triangle {
      transform: rotate(45deg);
      position: absolute;
      top: -45px;
      right: -160px;
      width: 100%;
      height: 153%;
      background-color: #f50057;
    }
    .content {
      z-index: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding-left: 15px;
    }
    .store-name {
      position: absolute;
      right: 200px;
      top: 25px;
      color: white;
      padding: 4px;
      font-size: 8rem;
      font-weight: bold;
    }
    .store-name::before, .store-name::after {
      content: "‚≠ê";
      margin: 0 2px;
    }
    .desc {
      position: absolute;
      right: 210px;
      top: 140px;
      color: white;
      padding: 4px;
      font-size: 0.85rem;
      font-weight: bold;
    }
    .amount-box {
      position: absolute;
      left: 20px;
      top: 85px;
      font-size: 1.2rem;
      font-weight: bold;
      color: #ffffff;
      background-color: black;
      padding: 4px 12px;
      border-radius: 10px;
      display: inline-block;
      width: fit-content;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .qr {
      position: absolute;
      right: 5px;
      top: 50%;
      transform: translateY(-50%);
      background: white;
      padding: 8px;
      border: 3px solid #2ecc71;
      border-radius: 8px;
      z-index: 2;
    }
    .qr img {
      width: 80px;
      height: 80px;
    }
    .btn-group {
      display: none;
      margin-top: 10px;
      gap: 10px;
    }
    .btn-group button {
      background-color: #3498db;
      color: white;
      padding: 10px 14px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .btn-group button:hover {
      background-color: #2980b9;
    }
    @media (max-width: 400px) {
      .qr img {
        width: 115px;
        height: 115px;
      }
      .store-name {
        font-size: 0.8rem;
      }
      .desc {
        font-size: 0.70rem;
      }
      .amount-box {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="input-card" id="inputSection">
    <center><h2>üôè Pay ‡§ï‡§∞‡•á‡§Ç üôè</h2></center><br>
    <p>QR ‡§ï‡•ã‡§° ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è UPI ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≠‡§∞‡•á‡§Ç:</p><br>
    <input type="text" id="upiId" placeholder="Enter your UPI ID" value="dhaurasi@ybl">
    <input type="number" id="amount" placeholder="Enter Amount (‚Çπ)">
    <button onclick="generateQR()">Generate QR</button>
  </div>
  <div class="card" id="atmCard">
    <div class="triangle"></div>
    <div class="content">
      <div class="store-name">Anil Kumar</div>
      <div class="desc" id="descText">Scan & Pay UPI</div>
      <div class="amount-box" id="amountBox">‚Çπ0</div>
    </div>
    <div class="qr">
      <img id="qrImage" src="" alt="Generated QR">
    </div>
  </div>
  <div class="btn-group" id="btnGroup">
    <button onclick="downloadCard()">üì• Download</button>
    <button onclick="regenerate()">üîÑ Regenerate</button>
  </div>
  <script>
    function generateQR() {
      const upi = document.getElementById("upiId").value.trim();
      const amount = document.getElementById("amount").value.trim();
      if (!upi || !amount || !upi.includes("@")) {
        alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§∏‡§π‡•Ä UPI ID ‡§î‡§∞ Amount ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç‡•§");
        return;
      }
      const qrData = `upi://pay?pa=${upi}&pn=AnilDigitalStore&am=${amount}`;
      const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(qrData)}`;
      const qrImg = document.getElementById("qrImage");
      qrImg.crossOrigin = "anonymous";
      qrImg.src = qrUrl;
      document.getElementById("descText").textContent = `Scan & Pay UPI`;
      document.getElementById("amountBox").textContent = `‚Çπ${amount}`;
      document.getElementById("atmCard").style.display = "flex";
      document.getElementById("btnGroup").style.display = "flex";
      document.getElementById("inputSection").style.display = "none";
    }
    function downloadCard() {
      const card = document.getElementById("atmCard");
      html2canvas(card, {
        useCORS: true,
        allowTaint: false
      }).then(canvas => {
        const link = document.createElement("a");
        link.download = 'Anil_Kumar_QR.jpg';
        link.href = canvas.toDataURL("image/jpeg", 1.0);
        link.click();
      });
    }
    function regenerate() {
      document.getElementById("inputSection").style.display = "block";
      document.getElementById("atmCard").style.display = "none";
      document.getElementById("btnGroup").style.display = "none";
      document.getElementById("upiId").value = "dhaurasi@ybl";
      document.getElementById("amount").value = "";
    }

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(reg => console.log('Service Worker Registered', reg))
          .catch(err => console.error('Service Worker registration failed', err));
      });
    }
  </script>
</body>
</html>
